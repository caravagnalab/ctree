<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ctree • ctree</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="ctree">
<meta property="og:description" content="ctree">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ctree</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/ctree.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="ctree_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>ctree</h1>
            
      
      
      <div class="hidden name"><code>ctree.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># To render in colour this vignette</span>
<span class="va">old.hooks</span> <span class="op">&lt;-</span> <span class="fu">fansi</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/fansi/man/set_knit_hooks.html" class="external-link">set_knit_hooks</a></span><span class="op">(</span><span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/knit_hooks.html" class="external-link">knit_hooks</a></span><span class="op">)</span></code></pre></div>
<style type="text/css" scoped>
PRE.fansi SPAN {padding-top: .25em; padding-bottom: .25em};
</style>
<p>The <code>ctree</code> is a package to implement basic functions to create, manipulate and visualize clone trees. A clone tree is a tree built from the results of a subclonal deconvolution analysis of bulk DNA sequencing data. The trees created with <code>ctree</code> are used inside <a href="https://github.com/caravagn/revolver" class="external-link">REVOLVER</a>, a package that implements one algorithm to determine <a href="https://www.nature.com/articles/s41592-018-0108-x" class="external-link">repeated cancer evolution from multi-region sequencing data of human cancers</a>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">ctree</span><span class="op">)</span></code></pre></div>
<p>To build a clone tree you need some basic datal; an example dataset is attached to the package and can be used to create a <code>ctree</code> S3 object.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">'ctree_input'</span><span class="op">)</span></code></pre></div>
<div class="section level3">
<h3 id="required-data">Required data<a class="anchor" aria-label="anchor" href="#required-data"></a>
</h3>
<p><strong>Cancer Cell Fractions</strong></p>
<p>Cancer Cell Fractions (CCF) clusters obtained from subclonal deconvolution analysis of bulk DNA sequencing data are required,</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ctree_input</span><span class="op">$</span><span class="va">CCF_clusters</span></code></pre></div>
<pre class="fansi fansi-output"><code><span class="co">#&gt; # A tibble: 7 × 7</span>
<span class="co">#&gt;   cluster nMuts is.driver is.clonal    R1    R2    R3</span>
<span class="co">#&gt;   &lt;chr&gt;   &lt;int&gt; &lt;lgl&gt;     &lt;lgl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1 1          72 TRUE      FALSE      0     0.92  0   </span>
<span class="co">#&gt; 2 2          69 TRUE      TRUE       0.99  0.98  0.99</span>
<span class="co">#&gt; 3 3          48 FALSE     FALSE      0     0     0.49</span>
<span class="co">#&gt; 4 4          29 FALSE     FALSE      0.01  0.01  0.93</span>
<span class="co">#&gt; 5 5          24 TRUE      FALSE      0.78  0     0   </span>
<span class="co">#&gt; 6 6          23 TRUE      FALSE      0.98  0.03  0.98</span>
<span class="co">#&gt; 7 7          15 FALSE     FALSE      0     0.41  0</span></code></pre>
<p>If you need tools to compute CCF values, the <a href="https://caravagn.github.io/evoverse/" class="external-link">evoverse</a> collection of packages for Cancer Evolution analysis contains both <a href="https://caravagn.github.io/mobster/" class="external-link">MOBSTER</a> and <a href="https://caravagn.github.io/viber/" class="external-link">VIBER</a>. Otherwise, a number of other packages can be used (pyClone, sciClone, DPClust, etc.).</p>
<p>Driver events mapped to the CCF clusters, with reported clonality status, a <code>variantID</code> and a <code>patientID.</code></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ctree_input</span><span class="op">$</span><span class="va">drivers</span></code></pre></div>
<pre class="fansi fansi-output"><code><span class="co">#&gt; # A tibble: 7 × 8</span>
<span class="co">#&gt;   patientID variantID is.driver is.clonal cluster    R1    R2    R3</span>
<span class="co">#&gt;   &lt;chr&gt;     &lt;chr&gt;     &lt;lgl&gt;     &lt;lgl&gt;     &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1 CRUK0002  RB1       TRUE      FALSE     1        0     0.92  0   </span>
<span class="co">#&gt; 2 CRUK0002  IKZF1     TRUE      FALSE     1        0     0.92  0   </span>
<span class="co">#&gt; 3 CRUK0002  KRAS      TRUE      FALSE     1        0     0.93  0   </span>
<span class="co">#&gt; 4 CRUK0002  MET       TRUE      TRUE      2        0.99  0.98  0.99</span>
<span class="co">#&gt; 5 CRUK0002  TERT      TRUE      TRUE      2        0.99  0.98  0.99</span>
<span class="co">#&gt; 6 CRUK0002  NF1       TRUE      FALSE     5        0.78  0     0   </span>
<span class="co">#&gt; 7 CRUK0002  EP300     TRUE      FALSE     6        0.96  0.03  0.98</span></code></pre>
<p><strong>Other data</strong></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ctree_input</span><span class="op">$</span><span class="va">samples</span>
<span class="co">#&gt; [1] "R1" "R2" "R3"</span>
<span class="va">ctree_input</span><span class="op">$</span><span class="va">patient</span>
<span class="co">#&gt; [1] "CUK12345"</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="creation-of-a-clone-tree">Creation of a clone tree<a class="anchor" aria-label="anchor" href="#creation-of-a-clone-tree"></a>
</h3>
<p>You can use a sampler and control its parameters – see <code>~ctrees</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="../reference/ctrees.html">ctrees</a></span><span class="op">(</span>
  CCF_clusters <span class="op">=</span> <span class="va">ctree_input</span><span class="op">$</span><span class="va">CCF_clusters</span>, 
  drivers <span class="op">=</span> <span class="va">ctree_input</span><span class="op">$</span><span class="va">drivers</span>,
  samples <span class="op">=</span> <span class="va">ctree_input</span><span class="op">$</span><span class="va">samples</span>,
  patient <span class="op">=</span> <span class="va">ctree_input</span><span class="op">$</span><span class="va">patient</span>,
  sspace.cutoff <span class="op">=</span> <span class="va">ctree_input</span><span class="op">$</span><span class="va">sspace.cutoff</span>,
  n.sampling <span class="op">=</span> <span class="va">ctree_input</span><span class="op">$</span><span class="va">n.sampling</span>,
  store.max <span class="op">=</span> <span class="va">ctree_input</span><span class="op">$</span><span class="va">store.max</span>
<span class="op">)</span></code></pre></div>
<pre class="fansi fansi-output"><code><span class="co">#&gt;  [ ctree ~ clone trees generator for CUK12345 ] </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; # A tibble: 7 × 7</span>
<span class="co">#&gt;   cluster nMuts is.driver is.clonal    R1    R2    R3</span>
<span class="co">#&gt;   &lt;chr&gt;   &lt;int&gt; &lt;lgl&gt;     &lt;lgl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1 1          72 TRUE      FALSE      0     0.92  0   </span>
<span class="co">#&gt; 2 2          69 TRUE      TRUE       0.99  0.98  0.99</span>
<span class="co">#&gt; 3 3          48 FALSE     FALSE      0     0     0.49</span>
<span class="co">#&gt; 4 4          29 FALSE     FALSE      0.01  0.01  0.93</span>
<span class="co">#&gt; 5 5          24 TRUE      FALSE      0.78  0     0   </span>
<span class="co">#&gt; 6 6          23 TRUE      FALSE      0.98  0.03  0.98</span>
<span class="co">#&gt; 7 7          15 FALSE     FALSE      0     0.41  0</span></code></pre>
<pre><code><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Trees per region <span style="color: #00BB00;">1, 3, 1</span></span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Total <span style="color: #00BB00;">3</span> tree structures - search is <span style="font-weight: bold;">exahustive</span></span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Ranking trees</span>
<span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #00BB00;">3</span>  trees with non-zero score, storing <span style="font-weight: bold;">3</span></span></code></pre>
<p>The sampler creates a number of clone trees that can fit the data according to an error model that allows violations of the pigeonhole principle. We work with the top-ranking model.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">=</span> <span class="va">x</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="visualisations">Visualisations<a class="anchor" aria-label="anchor" href="#visualisations"></a>
</h3>
<p>S3 functions for printing, and summarizing the object.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></code></pre></div>
<pre class="fansi fansi-output"><code><span class="co">#&gt;  [ ctree - ctree rank 1/3 for CUK12345 ] </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; # A tibble: 7 × 7</span>
<span class="co">#&gt;   cluster nMuts is.driver is.clonal    R1    R2    R3</span>
<span class="co">#&gt;   &lt;chr&gt;   &lt;int&gt; &lt;lgl&gt;     &lt;lgl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1 1          72 TRUE      FALSE      0     0.92  0   </span>
<span class="co">#&gt; 2 2          69 TRUE      TRUE       0.99  0.98  0.99</span>
<span class="co">#&gt; 3 3          48 FALSE     FALSE      0     0     0.49</span>
<span class="co">#&gt; 4 4          29 FALSE     FALSE      0.01  0.01  0.93</span>
<span class="co">#&gt; 5 5          24 TRUE      FALSE      0.78  0     0   </span>
<span class="co">#&gt; 6 6          23 TRUE      FALSE      0.98  0.03  0.98</span>
<span class="co">#&gt; 7 7          15 FALSE     FALSE      0     0.41  0   </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Tree shape (drivers annotated)  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   \-GL</span>
<span class="co">#&gt;    \-2 :: MET, TERT</span>
<span class="co">#&gt;     |-1 :: RB1, IKZF1, KRAS</span>
<span class="co">#&gt;     | \-7</span>
<span class="co">#&gt;     \-6 :: EP300</span>
<span class="co">#&gt;      |-4</span>
<span class="co">#&gt;      | \-3</span>
<span class="co">#&gt;      \-5 :: NF1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Information transfer  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;    MET ---&gt; RB1 </span>
<span class="co">#&gt;    MET ---&gt; IKZF1 </span>
<span class="co">#&gt;    MET ---&gt; KRAS </span>
<span class="co">#&gt;    TERT ---&gt; RB1 </span>
<span class="co">#&gt;    TERT ---&gt; IKZF1 </span>
<span class="co">#&gt;    TERT ---&gt; KRAS </span>
<span class="co">#&gt;    GL ---&gt; MET </span>
<span class="co">#&gt;    GL ---&gt; TERT </span>
<span class="co">#&gt;    EP300 ---&gt; NF1 </span>
<span class="co">#&gt;    MET ---&gt; EP300 </span>
<span class="co">#&gt;    TERT ---&gt; EP300 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Tree score 0.6 </span>
<span class="co">#&gt; </span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></code></pre></div>
<pre class="fansi fansi-output"><code><span class="co">#&gt;  [ ctree - ctree rank 1/3 for CUK12345 ] </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; # A tibble: 7 × 7</span>
<span class="co">#&gt;   cluster nMuts is.driver is.clonal    R1    R2    R3</span>
<span class="co">#&gt;   &lt;chr&gt;   &lt;int&gt; &lt;lgl&gt;     &lt;lgl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1 1          72 TRUE      FALSE      0     0.92  0   </span>
<span class="co">#&gt; 2 2          69 TRUE      TRUE       0.99  0.98  0.99</span>
<span class="co">#&gt; 3 3          48 FALSE     FALSE      0     0     0.49</span>
<span class="co">#&gt; 4 4          29 FALSE     FALSE      0.01  0.01  0.93</span>
<span class="co">#&gt; 5 5          24 TRUE      FALSE      0.78  0     0   </span>
<span class="co">#&gt; 6 6          23 TRUE      FALSE      0.98  0.03  0.98</span>
<span class="co">#&gt; 7 7          15 FALSE     FALSE      0     0.41  0   </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Tree shape (drivers annotated)  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   \-GL</span>
<span class="co">#&gt;    \-2 :: MET, TERT</span>
<span class="co">#&gt;     |-1 :: RB1, IKZF1, KRAS</span>
<span class="co">#&gt;     | \-7</span>
<span class="co">#&gt;     \-6 :: EP300</span>
<span class="co">#&gt;      |-4</span>
<span class="co">#&gt;      | \-3</span>
<span class="co">#&gt;      \-5 :: NF1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Information transfer  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;    MET ---&gt; RB1 </span>
<span class="co">#&gt;    MET ---&gt; IKZF1 </span>
<span class="co">#&gt;    MET ---&gt; KRAS </span>
<span class="co">#&gt;    TERT ---&gt; RB1 </span>
<span class="co">#&gt;    TERT ---&gt; IKZF1 </span>
<span class="co">#&gt;    TERT ---&gt; KRAS </span>
<span class="co">#&gt;    GL ---&gt; MET </span>
<span class="co">#&gt;    GL ---&gt; TERT </span>
<span class="co">#&gt;    EP300 ---&gt; NF1 </span>
<span class="co">#&gt;    MET ---&gt; EP300 </span>
<span class="co">#&gt;    TERT ---&gt; EP300 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Tree score 0.6 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; CCF clusters:  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; # A tibble: 7 × 7</span>
<span class="co">#&gt;   cluster nMuts is.driver is.clonal    R1    R2    R3</span>
<span class="co">#&gt;   &lt;chr&gt;   &lt;int&gt; &lt;lgl&gt;     &lt;lgl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1 1          72 TRUE      FALSE      0     0.92  0   </span>
<span class="co">#&gt; 2 2          69 TRUE      TRUE       0.99  0.98  0.99</span>
<span class="co">#&gt; 3 3          48 FALSE     FALSE      0     0     0.49</span>
<span class="co">#&gt; 4 4          29 FALSE     FALSE      0.01  0.01  0.93</span>
<span class="co">#&gt; 5 5          24 TRUE      FALSE      0.78  0     0   </span>
<span class="co">#&gt; 6 6          23 TRUE      FALSE      0.98  0.03  0.98</span>
<span class="co">#&gt; 7 7          15 FALSE     FALSE      0     0.41  0   </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Drivers:  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; # A tibble: 7 × 8</span>
<span class="co">#&gt;   patientID variantID is.driver is.clonal cluster    R1    R2    R3</span>
<span class="co">#&gt;   &lt;chr&gt;     &lt;chr&gt;     &lt;lgl&gt;     &lt;lgl&gt;     &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1 CRUK0002  RB1       TRUE      FALSE     1        0     0.92  0   </span>
<span class="co">#&gt; 2 CRUK0002  IKZF1     TRUE      FALSE     1        0     0.92  0   </span>
<span class="co">#&gt; 3 CRUK0002  KRAS      TRUE      FALSE     1        0     0.93  0   </span>
<span class="co">#&gt; 4 CRUK0002  MET       TRUE      TRUE      2        0.99  0.98  0.99</span>
<span class="co">#&gt; 5 CRUK0002  TERT      TRUE      TRUE      2        0.99  0.98  0.99</span>
<span class="co">#&gt; 6 CRUK0002  NF1       TRUE      FALSE     5        0.78  0     0   </span>
<span class="co">#&gt; 7 CRUK0002  EP300     TRUE      FALSE     6        0.96  0.03  0.98</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Pigeonhole principle: 12 0 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     R1   R2   R3</span>
<span class="co">#&gt; 1 TRUE TRUE TRUE</span>
<span class="co">#&gt; 2 TRUE TRUE TRUE</span>
<span class="co">#&gt; 4 TRUE TRUE TRUE</span>
<span class="co">#&gt; 6 TRUE TRUE TRUE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Goodness-of-fit: 1  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span></code></pre>
<p>Then some plotting functions for the tree. A tree layout is used to display the clone tree and the information transfer, which corresponds to the ordering of the drivers annnotated in the tree. This terminology is borrowed from the <a href="https://github.com/caravagn/revolver" class="external-link">REVOLVER</a> algorithm, where it is used to refer to the set of trajectories that a patient “transfers” to another patient during the fit.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="co">#&gt; Warning: Duplicated aesthetics after name standardisation: na.rm</span>
<span class="co">#&gt; Warning: `guides(&lt;scale&gt; = FALSE)` is deprecated. Please use `guides(&lt;scale&gt; =</span>
<span class="co">#&gt; "none")` instead.</span>
<span class="co">#&gt; Warning: Removed 1 rows containing missing values (geom_point).</span></code></pre></div>
<p><img src="ctree_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_information_transfer.html">plot_information_transfer</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="co">#&gt; Warning: `guides(&lt;scale&gt; = FALSE)` is deprecated. Please use `guides(&lt;scale&gt; =</span>
<span class="co">#&gt; "none")` instead.</span></code></pre></div>
<p><img src="ctree_files/figure-html/unnamed-chunk-10-2.png" width="700"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_icon.html">plot_icon</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="co">#&gt; Warning: `guides(&lt;scale&gt; = FALSE)` is deprecated. Please use `guides(&lt;scale&gt; =</span>
<span class="co">#&gt; "none")` instead.</span></code></pre></div>
<p><img src="ctree_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<p>For the data, you can plot the CCF of the clusters.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_CCF_clusters.html">plot_CCF_clusters</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="co">#&gt; Warning: Removed 8 rows containing missing values (geom_text).</span></code></pre></div>
<p><img src="ctree_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<p>Or you can plot the size of each CCF cluster as a barplot. This barplot is annotated to report wether a subclone with a driver is significantly larger than the expected size for a subclone without driver. To carry out this test subclones without drivers are used to estimate the parameters of a univariate Gaussian distribution (mean and standard deviation), the p-value is then computed from the fit distribution through the <code>pnorm</code> function. The confidence level for the test can be passed as parameter.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_clone_size.html">plot_clone_size</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="co">#&gt; Warning: Removed 3 rows containing missing values (geom_text).</span></code></pre></div>
<p><img src="ctree_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Giulio Caravagna.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
